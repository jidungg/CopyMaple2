import bpy
import os

# FBX 파일이 저장된 디렉토리 경로를 입력하세요.
directory = "D:\Workbench\Portfolio\CopyMaple2\Client\Bin\Resources\FBXs\MAP\Cube"  # 디렉토리 경로 변경

# 디렉토리에 있는 모든 FBX 파일 가져오기
fbx_files = [f for f in os.listdir(directory) if f.endswith('.fbx')]

if not fbx_files:
    print("FBX 파일이 디렉토리에 없습니다.")
else:
    for fbx_file in fbx_files:
        filepath = os.path.join(directory, fbx_file)
        print(f"파일 가져오기: {filepath}")
        bpy.ops.import_scene.fbx(filepath=filepath)
        for obj in bpy.context.scene.objects:
            if obj.parent is None:  # 부모가 없는 객체
                obj.rotation_euler[0] = 0  # Rotation X 값을 0으로 설정
                print(f"최상위 객체 '{obj.name}'의 Rotation X 값 변경")
        output_path = os.path.join(directory, fbx_file)  # 파일 이름에 "output_" 추가
        bpy.ops.export_scene.fbx(filepath=output_path)
        print(f"변환 후 저장: {output_path}")
        bpy.ops.object.select_all(action='SELECT')  # 모든 객체 선택
        bpy.ops.object.delete(use_global=False)     # 선택한 객체 삭제
        bpy.ops.outliner.orphans_purge()            # 고아 데이터 삭제
        print("씬 초기화 완료.")
    print("모든 작업 완료!")